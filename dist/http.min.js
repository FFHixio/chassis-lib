var parser=new DOMParser;window.HTTP={xhr:function(e){var t;return window.XMLHttpRequest&&(t=new XMLHttpRequest),t.onreadystatechange=function(){4==t.readyState&&e&&e(t)},t},run:function(e,t,r){var n=HTTP.xhr(r);n.open(e,t,!0),n.send()},applyRequestSettings:function(e,t){if(!e||!t)throw new Error("No XHR or configuration object defined.");if(t.params){var r=Object.keys(t.params).map(function(e){return e+"="+encodeURIComponent(t.params[e])});t.url+="?"+r.join("&"),console.log(t.url)}e.open(t.method||"POST",t.url,!0),t.header=t.header||t.headers||{},Object.keys(t.header).forEach(function(r){e.setRequestHeader(r,t.header[r])});var n=null;if(t.json)(!t.header||t.header&&!t.header["Content-Type"])&&e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n=JSON.stringify(t.json).trim();else if(t.body)(!t.header||t.header&&!t.header["Content-Type"])&&e.setRequestHeader("Content-Type","application/text"),n=t.body;else if(t.form){var n=new FormData;Object.keys(t.form).forEach(function(e){n.append(e,t.form[e])})}return t.withCredentials&&(e.withCredentials=t.withCredentials),t.username&&t.password?e.setRequestHeader("Authorization","Basic "+btoa(t.username+":"+t.password)):t.accessToken&&e.setRequestHeader("Authorization","Bearer "+t.accessToken),n},send:function(e,t){e=e||{};var r=this.xhr(t),n=this.applyRequestSettings(r,e);r.send(n)},prepend:function(e,t){var e=Array.prototype.slice.call(e);return e.unshift(t),e},get:function(){if("object"==typeof arguments[0]){var e=arguments[0];return e.method="GET",e.url="string"==typeof arguments[1]?arguments[1]:e.url,this.send(e,arguments[arguments.length-1])}this.run.apply(this.run,this.prepend(arguments,"GET"))},put:function(e,t){e=e||{},e.method="PUT",e.url=e.url||window.location,this.send(e,t)},post:function(e,t){e=e||{},e.method="POST",e.url=e.url||window.location,this.send(e,t)},"delete":function(){this.run.apply(this.run,this.prepent(arguments,"DELETE"))},json:function(e,t,r){"string"==typeof e&&(r=t,t=e,e=null),null===e?this.run("GET",t,function(e){if(200!==e.status)throw Error("Could not retrieve JSON data from "+t+" (Status Code: "+e.status+").");try{e.json=JSON.parse(e.responseText)}catch(n){e.json=null}r&&r(e.json)}):(e.url=t,this.get(e,function(e){if(200!==e.status)throw Error("Could not retrieve JSON data from "+t+" (Status Code: "+e.status+").");try{e.json=JSON.parse(e.responseText)}catch(n){e.json=null}r&&r(e.json)}))},normalizeUrl:function(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")},"import":function(e,t,r){var n=null;try{if(n=e.split("/").pop().split("?")[0].split(".").pop().toLowerCase(),"js"===n){var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e)}else if("css"===n){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e)}document.getElementsByTagName("head")[0].appendChild(o),t&&t()}catch(i){}if(!(["js","css"].indexOf((n||"").trim().toLowerCase())>=0)){if(r="boolean"==typeof r?r:!1,"http"!==e.substr(0,4)){var s=window.location.href.split("/");s.pop(),e=s.join("/")+"/"+e}if(!r&&this.importCache.hasOwnProperty(e)){var a=this.createElement(this.importCache[e]);return t&&t(1===a.length?a[0]:a),window.BUS&&window.BUS.emit("html.import",1===a.length?a[0]:a),void delete a}var p=this;this.get(e,function(r){if(200!==r.status)return console.warn("Check the file path of the snippet that needs to be imported. "+e+" could not be found ("+r.status+")");var n=p.createElement(r.responseText);if(p.importCache[e]=r.responseText,0===n.length)console.warn(p.normalizeUrl(e)+" import has no HTML tags."),t&&t(r.responseText),window.BUS&&window.BUS.emit("html.import",r.responseText);else{var o=1===n.length?n[0]:n;t&&t(o),window.BUS&&window.BUS.emit("html.import",o)}delete div})}},importTo:function(e,t,r){this["import"](e,function(e){if("string"==typeof e)e=document.createTextNode(e);else if(e.length){var n=[];return Array.prototype.slice.call(e).forEach(function(e){n.push(t.appendChild(e))}),void(r&&r(n))}t.appendChild(e),r&&r(e)})},importBefore:function(e,t,r){this["import"](e,function(e){if("string"==typeof e)e=document.createTextNode(e);else if(e.length){var n=[];return Array.prototype.slice.call(e).forEach(function(e){n.push(t.parentNode.insertBefore(e,t)),t=e}),void(r&&r(n))}t.parentNode.insertBefore(e,t),r&&r(e)})},template:function(e,t,r){e=this.normalizeUrl(e),"function"==typeof t&&(r=t,t={}),t=t||{};var n,o=this;return this.importCache.hasOwnProperty(e)?(n=this.importCache[e],this.applyData(n,t,r)):void this.get(e,function(n){var i=null;try{i=e.split("/").pop().split("?")[0].split(".").pop().toLowerCase()}catch(s){}return["js","css"].indexOf((i||"").trim().toLowerCase())>=0?void console.warn("Cannot use a ."+i+" file as a template. Only HTML templates are supported."):(o.importCache[e]=n.responseText,void o.applyData(n.responseText,t,r))})}},Object.defineProperties(window.HTTP,{importCache:{enumerable:!1,writable:!0,configurable:!1,value:{}},createElement:{enumerable:!1,writable:!1,configurable:!1,value:function(e){return parser.parseFromString(e,"text/html").querySelector("body").children}},applyData:{enumerable:!1,writable:!1,configurable:!1,value:function(e,t,r){if(void 0===e)return console.warn("Empty template."),void(r&&r());Object.keys(t).forEach(function(r){var n=new RegExp("{{"+r+"}}","gm");e=e.replace(n,t[r])}),e=e.replace(/(\{\{.*\}\})/gm,"");var n=this.createElement(e);r&&r(n[0]),delete n}}});