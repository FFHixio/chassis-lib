var BUS=function(){var n=[],e=[],r=[],t={},u=function(n,e){var r=n.filter(function(n){return e.toLowerCase()===n[0].toLowerCase()});return 0===r.length?null:(r.length>1&&console.warn("NGN Event Bus: "+r[0][0]+" exists more than once."),r[0].filter(function(n,e){return 0!==e}))},i=function(e){return u.apply(this,[n,e])},o=function(n){return u.apply(this,[e,n])},a=function(n){return u.apply(this,[r,n])};return Object.defineProperties(t,{subscribe:{enumerable:!0,configurable:!1,writable:!1,value:function(e,r){if(null===e||void 0===e||null===r||void 0===r)throw new Error("subscribe() requires a topic and listener function as arguments.");var t=i(e);null!==t&&t.unshift(e),null===t&&(t=[e])&&n.push(t);var u=t.push(r);return n[n.map(function(n){return n[0]}).indexOf(e)]=t,{unsubscribe:function(){t=t.splice(u,1),0===t.length?n.splice(n.map(function(n){return n[0]}).indexOf(e),1):n[n.map(function(n){return n[0]}).indexOf(e)]=t}}}},subscribeOnce:{enumerable:!0,configurable:!1,writable:!1,value:function(n,r){if(null===n||void 0===n||null===r||void 0===r)throw new Error("subscribeOnce() requires a topic and listener function as arguments.");var t=o(n);null!==t&&t.unshift(n),null===t&&(t=[n])&&e.push(t),t.push(r),e[e.map(function(n){return n[0]}).indexOf(n)]=t}},on:{enumerable:!0,configurable:!1,writable:!1,value:function(){return this.subscribe.apply(this,arguments)}},once:{enumerable:!0,configurable:!1,writable:!1,value:function(){return this.subscribeOnce.apply(this,arguments)}},bind:{enumerable:!0,configurable:!1,writable:!0,value:function(n,e,t){e="string"==typeof e?[e]:e;var u=a(n);null!==u&&u.unshift(n),null===u&&(u=[n])&&r.push(u);var i=this,o=function(n){e.forEach(function(e){i.publish(e,void 0!==n?n:{})})},c=u.push(o);return r[r.map(function(n){return n[0]}).indexOf(n)]=u,{remove:function(){u=u.splice(c,1),0===u.length?r.splice(r.map(function(n){return n[0]}).indexOf(n),1):r[r.map(function(n){return n[0]}).indexOf(n)]=u}}}},publish:{enumerable:!0,configurable:!1,writable:!1,value:function(t,u){var c=i(t),l=o(t),f=a(t);null!==c&&c.forEach(function(n){n(void 0!==u?u:{})}),null!==l&&(l.forEach(function(n){n(void 0!==u?u:{})}),e=e.filter(function(n){return n[0].toLowerCase()!==t.toLowerCase()})),null!==f&&f.forEach(function(n){n(void 0!==u?u:{})}),n.filter(function(n){if(n[0].indexOf("*")>=0){var e=new RegExp(n[0].replace("*",".*","gi"));return e.test(t)}return!1}).map(function(n){return n.slice(1,n.length)}).forEach(function(n){n.forEach(function(n){n(void 0!==u?u:{})})}),e.filter(function(n){if(n[0].indexOf("*")>=0){var e=new RegExp(n[0].replace("*",".*","gi"));return e.test(t)}return!1}).map(function(n){return n.slice(1,n.length)}).forEach(function(n){n.forEach(function(n){n(void 0!==u?u:{})})}),e=e.filter(function(n){if(n[0].indexOf("*")>=0){var e=new RegExp(n[0].replace("*",".*","gi"));return!e.test(t)}return!0}),r.filter(function(n){if(n[0].indexOf("*")>=0){var e=new RegExp(n[0].replace("*",".*","gi"));return e.test(t)}return!1}).forEach(function(n){n.forEach(function(n){n(void 0!==u?u:{})})})}},clear:{enumerable:!1,configurable:!1,writable:!1,value:function(t){n=n.filter(function(n){return n[0].toLowerCase()!==t.toLowerCase()}),e=e.filter(function(n){return n[0].toLowerCase()!==t.toLowerCase()}),r=r.filter(function(n){return n[0].toLowerCase()!==t.toLowerCase()})}},emit:{enumerable:!0,configurable:!1,writable:!1,value:function(){return this.publish.apply(this,arguments)}},subscribers:{enumerable:!0,get:function(){var r={};return n.forEach(function(n){r[n[0]]={persist:n.length-1,adhoc:0}}),e.forEach(function(n){r[n[0]]=r[n[0]]||{persist:0},r[n[0]].adhoc=n.length-1}),r}},persistentSubscribers:{enumerable:!0,get:function(){return n.map(function(n){return n[0]}).sort()}},adhocSubscribers:{enumerable:!0,get:function(){return e.map(function(n){return n[0]}).sort()}},autoSubscribers:{enumerable:!0,get:function(){return r.map(function(n){return n[0]}).sort()}},pool:{enumerable:!0,writable:!1,configurable:!1,value:function(n,e,r){"string"!=typeof n&&(e=n,n="");var t=this,u={};Object.keys(e).forEach(function(r){"function"==typeof e[r]?u[r]=t.subscribe((n.trim()||"")+r,e[r]):console.warn((n.trim()||"")+r+" could not be pooled in the event bus because it's value is not a function.")}),r&&r(u)}},attach:{enumerable:!0,writable:!1,configurable:!1,value:function(n){var e=this;return function(){var r=Array.prototype.slice.call(arguments);r.unshift(n),e.publish.apply(e,r)}}}}),t}();