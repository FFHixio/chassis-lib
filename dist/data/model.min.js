/**
  * v1.0.8 generated on: Fri Nov 20 2015 14:27:53 GMT-0600 (CST)
  * Copyright (c) 2014-2015, Corey Butler. All Rights Reserved.
  */
"use strict";window.NGN=window.NGN||{},window.NGN.DATA=window.NGN.DATA||{},window.NGN.DATA.Entity=function(e){e=e||{};var t=this;Object.defineProperties(this,{idAttribute:NGN.define(!1,!1,!1,e.idAttribute||"id"),fields:NGN.define(!1,!0,!0,e.fields||{id:{required:!0,type:String,"default":e.id||null}}),virtuals:NGN.define(!1,!0,!0,e.virtuals||{}),validators:NGN.define(!1,!0,!1,{}),validation:NGN.define(!0,!0,!1,NGN.coalesce(e.validation,!0)),isNew:NGN.define(!1,!0,!1,!0),isDestroyed:NGN.define(!1,!0,!1,!1),modified:NGN._get(function(){return this.changelog.length>0}),oid:NGN.define(!1,!0,!0,e[this.idAttribute]||null),id:{enumerable:!0,get:function(){return this.oid},set:function(e){this[this.idAttribute]=e,this.oid=e}},allowInvalidSave:NGN.define(!1,!0,!1,NGN.coalesce(e.allowInvalidSave,!1)),disableDataValidation:NGN.define(!1,!0,!1,NGN.coalesce(e.disableDataValidation,!1)),invalidDataAttributes:NGN.define(!1,!0,!1,[]),initialDataAttributes:NGN.define(!1,!0,!1,[]),changelog:NGN.define(!1,!0,!1,[]),_nativeValidators:NGN.define(!1,!1,!1,{min:function(e,t){return t instanceof Array?t.length>=e:t instanceof Number?t>=e:t instanceof String?t.trim().length>=e:t instanceof Date?t.parse()>=e.parse():!1},max:function(e,t){return t instanceof Array?t.length<=e:t instanceof Number?e>=t:t instanceof String?t.trim().length<=e:t instanceof Date?t.parse()<=e.parse():!1},"enum":function(e,t){return e.indexOf(t)>=0},required:function(e){return this.hasOwnProperty(e)}}),dataMap:NGN.define(!0,!0,!1,e.dataMap||null),raw:NGN.define(!1,!0,!1,{}),addValidator:NGN.define(!0,!1,!1,function(e,t){if(!this.hasOwnProperty(e))return void console.warn("No validator could be create for "+e.toUpperCase()+". It is not an attribute of "+this.type.toUpperCase()+".");switch(typeof t){case"function":this.validators[e]=this.validators[e]||[],this.validators[e].push(t),NGN.emit("validator.add",e);break;case"object":Array.isArray(t)?(this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return t.indexOf(e)>=0}),NGN.emit("validator.add",e)):t.test?(this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return t.test(e)}),NGN.emit("validator.add",e)):console.warn("No validator could be created for "+e.toUpperCase()+". The validator appears to be invalid.");break;case"string":case"number":case"date":this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return e===t}),NGN.emit("validator.add",e);break;default:console.warn("No validator could be create for "+e.toUpperCase()+". The validator appears to be invalid.")}}),removeValidator:NGN.define(!0,!1,!1,function(e){this.validators.hasOwnProperty(e)&&(delete this.validators[e],NGN.emit("validator.remove",e))}),validate:NGN.define(!0,!1,!1,function(e){var t=!0,i=this;if(e&&this.validators.hasOwnProperty(e)){for(n=0;n<this.validators[e].length;n++)if(!i.validators[e][n](i[e]))return i.invalidDataAttributes.indexOf(e)<0&&i.invalidDataAttributes.push(e),!1;return!0}for(var a in this.validators)if(this[a]&&this.validators.hasOwnProperty(a)){for(var r=!0,n=0;n<this.validators[a].length&&(r=this.validators[a][n](this[a]),r);n++);!r&&this.invalidDataAttributes.indexOf(a)<0&&this.invalidDataAttributes.push(a),t&&!r&&(t=!1)}return!0}),valid:NGN._get(function(){return 0===this.invalidDataAttributes.length}),datafields:NGN._get(function(){var e=[];for(var t in this.fields)e.push(t);return e}),getDataField:NGN.define(!0,!1,!1,function(e){return this.fields[e]}),hasDataField:NGN.define(!0,!1,!1,function(e){return this.fields.hasOwnProperty(e)}),record:NGN._get(function(){var e=this.serialize();if(this.dataMap){var t=this;Object.keys(this.dataMap).forEach(function(i){e.hasOwnProperty(i)&&(e[t.dataMap[i]]=e[i],delete e[i])})}return e}),serialize:NGN.define(!1,!1,!1,function(e){var t=e||this.raw,i={};for(var a in t)if(t.nonEnumerableProperties=t.nonEnumerableProperties||"",this.fields.hasOwnProperty(a)&&(a="id"===a?this.idAttribute:a,t.hasOwnProperty(a)&&t.nonEnumerableProperties.indexOf(a)<0&&/^[a-z0-9 ]$/.test(a.substr(0,1))||void 0!==t[a]&&t.enumerableProperties.indexOf(a)>=0)){var r=Object.getOwnPropertyDescriptor(t,a);if(!r.set)switch(typeof r.value){case"function":"Date"===r.value.name?i[a]=t[a].refs.toJSON():"RegExp"===r.value.name&&(i[a]=r.value());break;case"object":t[a]instanceof Array&&!Array.isArray(t[a])&&(t[a]=t[a].slice(0)),i[a]=t[a];break;default:i[a]=t[a]}}return i}),addField:NGN.define(!0,!1,!1,function(e,t){t=void 0!==t?t:!1;var i=this;if("id"!==e.toLowerCase()){if("object"==typeof e){if(!e.name)throw new Error("Cannot create data field. The supplied configuration does not contain a unique data field name.");var a=e;e=a.name,delete a.name}if(void 0!==i[e]&&(console.warn(e+" data field defined multiple times. Only the last defintion will be used."),delete i[e]),i.fields[e]=a||i.fields[e]||{},i.fields[e].required=NGN.coalesce(i.fields[e].required,!1),i.fields[e].type=NGN.coalesce(i.fields[e].type,String),i.fields[e]["default"]=NGN.coalesce(i.fields[e]["default"],null),i.raw[e]=i.fields[e]["default"],i[e]=i.raw[e],Object.defineProperty(i,e,{get:function(){return i.raw[e]},set:function(t){var a=i.raw[e];i.raw[e]=t;var r={action:"update",field:e,old:a,"new":i.raw[e]};this.changelog.push(r),NGN.emit("field.update",r),i.validate(e)||NGN.emit("field.invalid",{field:e})}}),!t){var r={action:"create",field:e};this.changelog.push(r),NGN.emit("field.create",r)}i.fields.hasOwnProperty(e)&&(i.fields[e].hasOwnProperty("pattern")&&i.addValidator(e,i.fields[e].pattern),["min","max","enum"].forEach(function(t){i.fields[e].hasOwnProperty(t)&&i.addValidator(e,function(a){return i._nativeValidators[t](i.fields[e],a)})}),i.fields[e].hasOwnProperty("required")&&i.fields[e].required&&i.addValidator(e,function(e){return i._nativeValidators.required(e)}),i.fields[e].hasOwnProperty("validate")&&("function"==typeof i.fields[e]?i.addValidator(e,function(t){return i.fields[e](t)}):console.warn("Invalid custom validation function. The value passed to the validate attribute must be a function.")))}}),removeField:NGN.define(!0,!1,!1,function(e){if(this.raw.hasOwnProperty(e)){var t=this.raw[e];delete this[e],delete this.fields[e],delete this.raw[e],this.invalidDataAttributes.indexOf(e)>=0&&this.invalidDataAttributes.splice(this.invalidDataAttributes.indexOf(e),1);var i={action:"delete",field:e,value:t};NGN.emit("field.delete",i),this.changelog.push(i)}}),history:NGN._get(function(){return this.changelog.reverse()}),undo:NGN.define(!0,!1,!1,function(e){e=e||1;var t=this.changelog.splice(this.changelog.length-e,e),i=this;t.reverse().forEach(function(e){switch(e.action){case"update":i[e.field]=e.old;break;case"create":i.removeField(e.field);break;case"delete":i.addField(e.field),i[e.field]=i.old}})}),load:NGN.define(!0,!1,!1,function(e){var t=this;e=e||{},Object.keys(e).forEach(function(i){t.raw.hasOwnProperty(i)?t.raw[i]=e[i]:console.warn(i+" was specified as a data field but is not defined in the model.")})})}),this.fields.hasOwnProperty("id")||(e.fields.id={required:!0,type:String,"default":e.id||null}),Object.keys(this.fields).forEach(function(e){t.addField(e,!0)})},window.NGN.DATA.Model=function(e){var t=function(t){this.constructor(e),t&&this.load(t)};return t.prototype=NGN.DATA.Entity.prototype,t};