/**
  * v1.0.8 generated on: Wed Nov 18 2015 21:35:02 GMT-0600 (CST)
  * Copyright (c) 2014-2015, Corey Butler. All Rights Reserved.
  */
"use strict";window.NGN=window.NGN||{},window.NGN.DATA=window.NGN.DATA||{},window.NGN.DATA.Model=function(e){e=e||{},Object.defineProperties(this,{emit:NGN.define(!1,!1,!1,function(e){window.NGN.BUS?NGN.BUS.emit.apply(NGN.BUS,arguments):console.info(e)}),idAttribute:NGN.define(!1,!1,!1,e.idAttribute||"id"),fields:NGN.define(!1,!0,!0,e.fields||{id:{required:!0,type:String,"default":e.id||null}}),virtuals:NGN.define(!1,!0,!0,e.virtuals||{}),validators:NGN.define(!1,!0,!1,{}),isNew:NGN.define(!1,!0,!1,!0),isDestroyed:NGN.define(!1,!0,!1,!1),modified:NGN.define(!0,!0,!1,!1),oid:NGN.define(!1,!0,!0,e[this.idAttribute]||null),id:{enumerable:!0,get:function(){return this.oid},set:function(e){this[this.idAttribute]=e,this.oid=e}},allowInvalidSave:NGN.define(!1,!0,!1,NGN.coalesce(e.allowInvalidSave,!1)),disableDataValidation:NGN.define(!1,!0,!1,NGN.coalesce(e.disableDataValidation,!1)),invalidDataAttributes:NGN.define(!1,!0,!1,[]),initialDataAttributes:NGN.define(!1,!0,!1,[]),fetched:NGN.define(!1,!0,!1,!1),initialized:NGN.define(!1,!0,!1,!1),changelog:NGN.define(!1,!0,!1,[]),changequeue:NGN.define(!1,!0,!0,[]),_nativeValidators:NGN.define(!1,!1,!1,{min:function(e,i){return i instanceof Array?i.length>=e:i instanceof Number?i>=e:i instanceof String?i.trim().length>=e:i instanceof Date?i.parse()>=e.parse():!1},max:function(e,i){return i instanceof Array?i.length<=e:i instanceof Number?e>=i:i instanceof String?i.trim().length<=e:i instanceof Date?i.parse()<=e.parse():!1},"enum":function(e,i){return e.indexOf(i)>=0},required:function(e){return this.hasOwnProperty(e)}}),dataMap:NGN.define(!0,!0,!1,e.dataMap||null),raw:NGN.define(!1,!0,!1,{}),addValidator:NGN.define(!0,!1,!1,function(e,i){if(!this.hasOwnProperty(e))return void console.warn("No validator could be create for "+e.toUpperCase()+". It is not an attribute of "+this.type.toUpperCase()+".");switch(typeof i){case"function":this.validators[e]=this.validators[e]||[],this.validators[e].push(i),this.emit("validator.add",e);break;case"object":Array.isArray(i)?(this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return i.indexOf(e)>=0}),this.emit("validator.add",e)):i.test?(this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return i.test(e)}),this.emit("validator.add",e)):console.warn("No validator could be created for "+e.toUpperCase()+". The validator appears to be invalid.");break;case"string":case"number":case"date":this.validators[e]=this.validators[e]||[],this.validators[e].push(function(e){return e===i}),this.emit("validator.add",e);break;default:console.warn("No validator could be create for "+e.toUpperCase()+". The validator appears to be invalid.")}}),removeValidator:NGN.define(!0,!1,!1,function(e){this.validators.hasOwnProperty(e)&&(delete this.validators[e],this.emit("validator.remove",e))}),validate:NGN.define(!0,!1,!1,function(e){if(!this.disableDataValidation){var i=!0;if(e&&this.validators.hasOwnProperty(e))return i=this.validationMap[e](this[e]),i||this.invalidDataAttributes.push(e),i;for(var t in this.validators)if(this[t]&&this.validators.hasOwnProperty(t)){for(var a=!0,n=0;n<this.validators[t].length&&(a=this.validators[t][n](this[t]),a);n++);!a&&this.invalidDataAttributes.indexOf(t)<0&&this.invalidDataAttributes.push(t),i&&!a&&(i=!1)}return!0}}),enableDataValidation:NGN.define(!0,!1,!1,function(){this.disableDataValidation=!1,this.emit("validation.enabled")}),datafields:NGN._get(function(){var e=[];for(var i in this.fields)e.push(i);return e}),getDataField:NGN.define(!0,!1,!1,function(e){return this.fields[e]}),hasDataField:NGN.define(!0,!1,!1,function(e){return this.fields.hasOwnProperty(e)}),serialize:NGN.define(!0,!1,!1,function(e){var i=e||this.raw,t={};for(var a in i)if(i.nonEnumerableProperties=i.nonEnumerableProperties||"",this.fields.hasOwnProperty(a)&&(a="id"===a?this.idAttribute:a,i.hasOwnProperty(a)&&i.nonEnumerableProperties.indexOf(a)<0&&/^[a-z0-9 ]$/.test(a.substr(0,1))||void 0!==i[a]&&i.enumerableProperties.indexOf(a)>=0)){var n=Object.getOwnPropertyDescriptor(i,a);if(!n.set)switch(typeof n.value){case"function":"Date"===n.value.name?t[a]=i[a].refs.toJSON():"RegExp"===n.value.name&&(t[a]=n.value());break;case"object":i[a]instanceof Array&&!Array.isArray(i[a])&&(i[a]=i[a].slice(0)),t[a]=i[a];break;default:t[a]=i[a]}}return t})}),this.fields.hasOwnProperty("id")||(e.fields.id={required:!0,type:String,"default":e.id||null});var i=this;Object.keys(this.fields).forEach(function(e){["id"].indexOf(e)<0&&(void 0!==i[e]&&(console.warn(e+" data field defined multiple times. Only the last defintion will be used."),delete i[e]),i.fields[e]=i.fields[e]||{},i.fields[e]={required:NGN.coalesce(i.fields[e].required,!1),type:NGN.coalesce(i.fields[e].type,String),"default":NGN.coalesce(i.fields[e]["default"],null)},i.raw[e]=i.fields[e]["default"],Object.defineProperty(i,e,{enumerable:!0,get:function(){return i.raw[e]},set:function(t){var a=i.raw[e];i.raw[e]=t,this.emit("field.modified",{old:a,"new":i.raw[e],field:e})}}),i.disableDataValidation||(i.fields[e].hasOwnProperty("pattern")&&i.addValidator(e,i.fields[e].pattern),["min","max","enum"].forEach(function(t){i.fields[e].hasOwnProperty(t)&&i.addValidator(e,function(a){return i._nativeValidators[t](i.fields[e],a)})}),i.fields[e].hasOwnProperty("required")&&i.fields[e].required&&i.addValidator(e,function(e){return i._nativeValidators.required(e)}),i.fields[e].hasOwnProperty("validate")&&("function"==typeof i.fields[e]?i.addValidator(e,function(t){return i.fields[e](t)}):console.warn("Invalid custom validation function. The value passed to the validate attribute must be a function."))))});var t=function(){return i};return t};